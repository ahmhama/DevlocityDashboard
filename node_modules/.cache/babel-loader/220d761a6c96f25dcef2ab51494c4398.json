{"ast":null,"code":"var _ = require('../helper');\n\nfunction assert(options, password) {\n  if (!password) {\n    return false;\n  }\n\n  var i,\n      current = {\n    c: null,\n    count: 0\n  };\n\n  for (i = 0; i < password.length; i++) {\n    if (current.c !== password[i]) {\n      current.c = password[i];\n      current.count = 1;\n    } else {\n      current.count++;\n    }\n\n    if (current.count > options.max) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction explain(options, verified) {\n  var example = new Array(options.max + 2).join('a');\n  var d = {\n    message: 'No more than %d identical characters in a row (e.g., \"%s\" not allowed)',\n    code: 'identicalChars',\n    format: [options.max, example]\n  };\n\n  if (verified !== undefined) {\n    d.verified = verified;\n  }\n\n  return d;\n}\n\nmodule.exports = {\n  validate: function (options) {\n    if (!_.isObject(options)) {\n      throw new Error('options should be an object');\n    }\n\n    if (!_.isNumber(options.max) || _.isNaN(options.max) || options.max < 1) {\n      throw new Error('max should be a number greater than 1');\n    }\n\n    return true;\n  },\n  explain: explain,\n  missing: function (options, password) {\n    return explain(options, assert(options, password));\n  },\n  assert: assert\n};","map":{"version":3,"names":["_","require","assert","options","password","i","current","c","count","length","max","explain","verified","example","Array","join","d","message","code","format","undefined","module","exports","validate","isObject","Error","isNumber","isNaN","missing"],"sources":["C:/Users/Lenovo/Desktop/New folder (2)/strikingDash/node_modules/password-sheriff/lib/rules/identicalChars.js"],"sourcesContent":["var _ = require('../helper');\n\nfunction assert(options, password) {\n  if (!password) {\n    return false;\n  }\n\n  var i, current = {c: null, count: 0};\n\n  for (i = 0; i < password.length; i++) {\n    if (current.c !== password[i]) {\n      current.c = password[i];\n      current.count = 1;\n    } else {\n      current.count++;\n    }\n\n    if (current.count > options.max) {\n      return false;\n    }\n  }\n\n  return true;\n}\nfunction explain (options, verified) {\n    var example = (new Array(options.max+2)).join('a');\n    var d = {\n      message: 'No more than %d identical characters in a row (e.g., \"%s\" not allowed)',\n      code: 'identicalChars',\n      format: [options.max, example]\n    };\n    if (verified !== undefined) {\n      d.verified = verified;\n    }\n    return d;\n  }\n\nmodule.exports = {\n  validate: function (options) {\n    if (!_.isObject(options)) {\n      throw new Error('options should be an object');\n    }\n\n    if (!_.isNumber(options.max) || _.isNaN(options.max) || options.max < 1 ) {\n      throw new Error('max should be a number greater than 1');\n    }\n\n    return true;\n  },\n  explain: explain,\n  missing: function (options, password) {\n    return explain(options, assert(options, password));\n  },\n  assert: assert\n};\n"],"mappings":"AAAA,IAAIA,CAAC,GAAGC,OAAO,CAAC,WAAD,CAAf;;AAEA,SAASC,MAAT,CAAgBC,OAAhB,EAAyBC,QAAzB,EAAmC;EACjC,IAAI,CAACA,QAAL,EAAe;IACb,OAAO,KAAP;EACD;;EAED,IAAIC,CAAJ;EAAA,IAAOC,OAAO,GAAG;IAACC,CAAC,EAAE,IAAJ;IAAUC,KAAK,EAAE;EAAjB,CAAjB;;EAEA,KAAKH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGD,QAAQ,CAACK,MAAzB,EAAiCJ,CAAC,EAAlC,EAAsC;IACpC,IAAIC,OAAO,CAACC,CAAR,KAAcH,QAAQ,CAACC,CAAD,CAA1B,EAA+B;MAC7BC,OAAO,CAACC,CAAR,GAAYH,QAAQ,CAACC,CAAD,CAApB;MACAC,OAAO,CAACE,KAAR,GAAgB,CAAhB;IACD,CAHD,MAGO;MACLF,OAAO,CAACE,KAAR;IACD;;IAED,IAAIF,OAAO,CAACE,KAAR,GAAgBL,OAAO,CAACO,GAA5B,EAAiC;MAC/B,OAAO,KAAP;IACD;EACF;;EAED,OAAO,IAAP;AACD;;AACD,SAASC,OAAT,CAAkBR,OAAlB,EAA2BS,QAA3B,EAAqC;EACjC,IAAIC,OAAO,GAAI,IAAIC,KAAJ,CAAUX,OAAO,CAACO,GAAR,GAAY,CAAtB,CAAD,CAA2BK,IAA3B,CAAgC,GAAhC,CAAd;EACA,IAAIC,CAAC,GAAG;IACNC,OAAO,EAAE,wEADH;IAENC,IAAI,EAAE,gBAFA;IAGNC,MAAM,EAAE,CAAChB,OAAO,CAACO,GAAT,EAAcG,OAAd;EAHF,CAAR;;EAKA,IAAID,QAAQ,KAAKQ,SAAjB,EAA4B;IAC1BJ,CAAC,CAACJ,QAAF,GAAaA,QAAb;EACD;;EACD,OAAOI,CAAP;AACD;;AAEHK,MAAM,CAACC,OAAP,GAAiB;EACfC,QAAQ,EAAE,UAAUpB,OAAV,EAAmB;IAC3B,IAAI,CAACH,CAAC,CAACwB,QAAF,CAAWrB,OAAX,CAAL,EAA0B;MACxB,MAAM,IAAIsB,KAAJ,CAAU,6BAAV,CAAN;IACD;;IAED,IAAI,CAACzB,CAAC,CAAC0B,QAAF,CAAWvB,OAAO,CAACO,GAAnB,CAAD,IAA4BV,CAAC,CAAC2B,KAAF,CAAQxB,OAAO,CAACO,GAAhB,CAA5B,IAAoDP,OAAO,CAACO,GAAR,GAAc,CAAtE,EAA0E;MACxE,MAAM,IAAIe,KAAJ,CAAU,uCAAV,CAAN;IACD;;IAED,OAAO,IAAP;EACD,CAXc;EAYfd,OAAO,EAAEA,OAZM;EAafiB,OAAO,EAAE,UAAUzB,OAAV,EAAmBC,QAAnB,EAA6B;IACpC,OAAOO,OAAO,CAACR,OAAD,EAAUD,MAAM,CAACC,OAAD,EAAUC,QAAV,CAAhB,CAAd;EACD,CAfc;EAgBfF,MAAM,EAAEA;AAhBO,CAAjB"},"metadata":{},"sourceType":"script"}